---
title: "Sprint#02: Ways towards A Net-Zero Society, Take NYC as an Example"
date: "2023-04-21"
output: pdf_document
---
```{r}
Sys.setenv('R_MAX_VSIZE'=32000000000)
library(tidyverse)
library(modelr)
```
```{r}
file_path <- file.path(dirname(rstudioapi::getSourceEditorContext()$path), "dataset/nyc_eui_census.csv")
raw_data <- read_csv(file_path)
eui_bg <- as_tibble(raw_data)
head(eui_bg)
```
```{r}
eui_bg_fil <- eui_bg %>%
  filter(Site_EUI__ < 500)
lm1 <- lm(Site_EUI__ ~ income * buildingType, data = eui_bg_fil)
lm1_data <- eui_bg_fil %>%
  data_grid(income, Site_EUI__, buildingType) %>%
  add_predictions(lm1) %>%
  add_residuals(lm1)
lm1_data
ggplot(data = eui_bg_fil) +
  geom_point(aes(x = income, y = Site_EUI__, color = buildingType), size = 0.2) +
  geom_line(data = lm1_data, aes(x = income, y = pred, color = buildingType)) +
  labs(x = "Income($)", y = "EUI(kBtu/sqft)", title = "Linear Regression of EUI vs Income") +
  theme(plot.title = element_text(hjust = 0.5))
```
```{r}
eui_bg_fil <- eui_bg %>%
  filter(Site_EUI__ < 500)
lm1 <- lm(Site_EUI__ ~ age, data = eui_bg_fil)
lm1_data <- eui_bg_fil %>%
  data_grid(age, Site_EUI__) %>%
  add_predictions(lm1) %>%
  add_residuals(lm1)
lm1_data
ggplot(data = eui_bg_fil) +
  geom_point(aes(x = age, y = Site_EUI__), size = 0.2) +
  geom_line(data = lm1_data, aes(x = age, y = pred))
```



```{r}
eui_bg_fil <- eui_bg %>%
  filter(Site_EUI__ < 500)
lm1 <- lm(Site_EUI__ ~ area, data = eui_bg_fil)
lm1_data <- eui_bg_fil %>%
  data_grid(area, Site_EUI__) %>%
  add_predictions(lm1) %>%
  add_residuals(lm1)
lm1_data
ggplot(data = eui_bg_fil) +
  geom_point(aes(x = area, y = Site_EUI__), size = 0.2) +
  geom_line(data = lm1_data, aes(x = area, y = pred))
```



```{r}
eui_bg_fil <- eui_bg %>%
  filter(Site_EUI__ < 500)
lm1 <- lm(Site_EUI__ ~ higherEduRate, data = eui_bg_fil)
lm1_data <- eui_bg_fil %>%
  data_grid(higherEduRate, Site_EUI__) %>%
  add_predictions(lm1) %>%
  add_residuals(lm1)
lm1_data
ggplot(data = eui_bg_fil) +
  geom_point(aes(x = higherEduRate, y = Site_EUI__), size = 0.2) +
  geom_line(data = lm1_data, aes(x = higherEduRate, y = pred))
```




```{r}
eui_bg_fil <- eui_bg %>%
  filter(Site_EUI__ < 500)
lm1 <- lm(Site_EUI__ ~ marriageRate, data = eui_bg_fil)
lm1_data <- eui_bg_fil %>%
  data_grid(marriageRate, Site_EUI__) %>%
  add_predictions(lm1) %>%
  add_residuals(lm1)
lm1_data
ggplot(data = eui_bg_fil) +
  geom_point(aes(x = marriageRate, y = Site_EUI__), size = 0.2) +
  geom_line(data = lm1_data, aes(x = marriageRate, y = pred))
```



```{r}
eui_bg_fil <- eui_bg %>%
  filter(Site_EUI__ < 500)
lm1 <- lm(Site_EUI__ ~ commuteTime, data = eui_bg_fil)
lm1_data <- eui_bg_fil %>%
  data_grid(commuteTime, Site_EUI__) %>%
  add_predictions(lm1) %>%
  add_residuals(lm1)
lm1_data
ggplot(data = eui_bg_fil) +
  geom_point(aes(x = commuteTime, y = Site_EUI__), size = 0.2) +
  geom_line(data = lm1_data, aes(x = commuteTime, y = pred))
```
```{r}

eui_bg_fil <- eui_bg %>%
  filter(Site_EUI__ < 500)
lm1 <- lm(Site_EUI__ ~ liveAloneRate, data = eui_bg_fil)
lm1_data <- eui_bg_fil %>%
  data_grid(liveAloneRate, Site_EUI__) %>%
  add_predictions(lm1) %>%
  add_residuals(lm1)
lm1_data
ggplot(data = eui_bg_fil) +
  geom_point(aes(x = liveAloneRate, y = Site_EUI__), size = 0.2) +
  geom_line(data = lm1_data, aes(x = liveAloneRate, y = pred))
```
```{r}
eui_bg_fil <- eui_bg %>%
  filter(Site_EUI__ < 500)
lm1 <- lm(Site_EUI__ ~ maleRate, data = eui_bg_fil)
lm1_data <- eui_bg_fil %>%
  data_grid(maleRate, Site_EUI__) %>%
  add_predictions(lm1) %>%
  add_residuals(lm1)
lm1_data
ggplot(data = eui_bg_fil) +
  geom_point(aes(x = maleRate, y = Site_EUI__), size = 0.2) +
  geom_line(data = lm1_data, aes(x = maleRate, y = pred))
```



```{r}
eui_bg_fil <- eui_bg %>%
  filter(Site_EUI__ < 500)
lm1 <- lm(Site_EUI__ ~ avgAge, data = eui_bg_fil)
lm1_data <- eui_bg_fil %>%
  data_grid(avgAge, Site_EUI__) %>%
  add_predictions(lm1) %>%
  add_residuals(lm1)
lm1_data
ggplot(data = eui_bg_fil) +
  geom_point(aes(x = avgAge, y = Site_EUI__), size = 0.2) +
  geom_line(data = lm1_data, aes(x = avgAge, y = pred))
```